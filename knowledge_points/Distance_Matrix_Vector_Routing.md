# çŸ¥è¯†ç‚¹å¤ä¹ ï¼šDistance Matrix & Distance Vector Routing (è·ç¦»çŸ©é˜µä¸è·ç¦»å‘é‡è·¯ç”±)

## ğŸ“Œ è€ƒé¢‘åˆ†æ (Testing Frequency)
- **è€ƒé¢‘è¯„çº§**ï¼š**æé«˜é¢‘ (Very High Frequency)**
- **å¤ä¹ å»ºè®®**ï¼š**å¿…è€ƒæ¨å›¾/çœ‹å›¾é¢˜ï¼æŒæ¡æœ€çŸ­è·¯å¾„è·³æ•°çš„æŸ¥æ³•ï¼Œç†Ÿè®°ç†è®ºå¯¹æ¯”**
- **è¯•å·è¦†ç›–æƒ…å†µ**ï¼š
  - å‡ ä¹æ¯å¹´çš„**æœŸä¸­è€ƒè¯• (Midterm)** éƒ½ä¼šè€ƒä¸€é“å¿…è€ƒçœ‹å›¾é¢˜ï¼ˆ"For which minimal $n$ does $D_n = D_{n+1}$ hold?"ï¼‰ã€‚å¦‚ 2016, 2019, 2022 å¹´ç­‰ã€‚
  - åœ¨æœŸæœ«è€ƒè¯•ä¸­ï¼Œé€šå¸¸æ¼”åŒ–ä¸ºå¯¹ **RIP åè®® (Routing Information Protocol)** å’Œ **Distance Vector vs Link State** çš„ç†è®ºå¯¹æ¯”ä¸æ›´æ–°è¡¨æ¨å¯¼ï¼ˆå¦‚ 2017, 2019 æœŸæœ«è€ƒï¼‰ã€‚

---

## ğŸ“š è€ƒç‚¹æ ¸å¿ƒä¸ç†è®ºæ·±æŒ– (Topic Overview & Core Concepts)

åœ¨ `slides_chap2.pdf` å’Œ `tutorial08` ä¸­ï¼Œä»‹ç»äº†è¡¨ç¤ºç½‘ç»œå›¾è¡¨çš„ä¸‰ç§çŸ©é˜µç»“æ„ï¼š
1. **Adjacency matrix (é‚»æ¥çŸ©é˜µ)**ï¼šä»…è¡¨ç¤ºèŠ‚ç‚¹æ˜¯å¦ç›´æ¥ç›¸è¿ï¼ˆ0 æˆ– 1ï¼‰ã€‚
2. **Distance matrix (è·ç¦»çŸ©é˜µ $D$)**ï¼šè¡¨ç¤ºç›¸é‚»èŠ‚ç‚¹çš„ç›´æ¥é“¾è·¯æˆæœ¬ (Link cost)ã€‚
3. **$D_n$ çš„å«ä¹‰ (Min-plus product)**ï¼šå°† $D$ çŸ©é˜µè¿›è¡Œè‡ªèº«ä¹˜æ³•è¿­ä»£ã€‚$D_2$ åŒ…å«äº†é€šè¿‡æœ€å¤š 2 æ¡è¾¹ (2 hops) çš„æœ€çŸ­è·¯å¾„æˆæœ¬ã€‚$D_n$ åŒ…å«äº†é€šè¿‡æœ€å¤š $n$ æ¡è¾¹çš„æœ€çŸ­è·¯å¾„æˆæœ¬ã€‚

### æ ¸å¿ƒè€ƒç‚¹ï¼šä»€ä¹ˆæ—¶å€™ $D_n = D_{n+1}$ï¼Ÿ
å½“ $D_n$ çŸ©é˜µå†…çš„æœ€çŸ­è·¯å¾„ä¸å†éšç€è¿­ä»£æ¬¡æ•°å¢å¤§è€Œæ”¹å˜æ—¶ï¼Œæ„å‘³ç€**ç½‘ç»œä¸­ä»»æ„ä¸¤ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯å¾„éƒ½å·²ç»æ‰¾åˆ°äº†**ã€‚
åœ¨è¿™ä¸ªè€ƒç‚¹é‡Œæœ‰ä¸€ä¸ª**æ ¸å¿ƒæ³•åˆ™**ï¼š
> "The power $n$ such that $D_n = D_{n+1}$ is determined by the **longest shortest path** in the network (in terms of edges/hops)."
> ï¼ˆä½¿å¾— $D_n = D_{n+1}$ æˆç«‹çš„æœ€å° $n$ å€¼ï¼Œç­‰äºè¿™ä¸ªç½‘ç»œæ‹“æ‰‘ä¸­ï¼Œ**èŠ‚ç‚¹ä¹‹é—´æœ€çŸ­è·¯å¾„ä¸­ï¼ŒåŒ…å«è¾¹æ•°ï¼ˆè·³æ•°ï¼‰æœ€å¤šçš„é‚£ä¸€æ¡è·¯å¾„çš„è¾¹æ•°**ã€‚ï¼‰

### Distance Vector Routing (è·ç¦»å‘é‡è·¯ç”±, ä¾‹å¦‚ RIP)
- **æ ¸å¿ƒç®—æ³•**ï¼šåˆ†å¸ƒå¼ **Bellman-Ford** ç®—æ³•ã€‚
- **å·¥ä½œåŸç†**ï¼šè·¯ç”±å™¨**ä¸çŸ¥é“å®Œæ•´çš„ç½‘ç»œæ‹“æ‰‘ç»“æ„**ï¼ˆno complete topologyï¼‰ï¼Œå®ƒä»¬åªçŸ¥é“è‡ªå·±çš„ç›´æ¥é‚»å±…ã€‚å®ƒä»¬å®šæœŸå°†è‡ªå·±åˆ°è¾¾å„ç›®çš„åœ°çš„è·ç¦»è¡¨ (Distance Vector) å‘é€ç»™é‚»å±…ã€‚
- **RIP è€ƒç‚¹**ï¼šä½¿ç”¨ **Hop Count** (è·³æ•°) ä½œä¸ºåº¦é‡ã€‚æœ€å¤§æœ‰æ•ˆè·³æ•°æ˜¯ 15 (16 ä»£è¡¨ä¸å¯è¾¾/æ— ç©·å¤§)ã€‚å¦‚æœåœ¨æ›´æ–°æ—¶æŸä¸ªé“¾è·¯æ–­äº†ï¼Œå®¹æ˜“äº§ç”Ÿ **Count to infinity (è®¡æ•°åˆ°æ— ç©·å¤§)** çš„ç»å…¸é—®é¢˜ã€‚

---

## ğŸ¯ è€ƒæ³•åˆ†æä¸å†å¹´çœŸé¢˜ (Past Questions & Answers)

### é¢˜å‹ 1ï¼šçœ‹å›¾æ•°è·³æ•° (The Matrix Convergence Calculation)
**Question:** Given is the distance matrix $D$ for the network next to it. For which minimal $n$ does $D_n = D_{n+1}$ hold?
*(é¢˜ç›®å¾€å¾€é…æœ‰ä¸€å¼ ç”±è‹¥å¹²ä¸ªèŠ‚ç‚¹ ABCDE è¿æ¥èµ·æ¥çš„ç½‘ç»œå›¾)*
**Answer:** *(ä¾‹å¦‚ $n=4$, $n=2$ ç­‰)*
ğŸ“ **å‡ºå¤„ (Source):** *[midterm_2019_en.md, Task 1f; midterm_2022_en.md, Task 1g]*
![alt text](image.png)

ğŸ’¡ **ä¸­æ–‡è§£æä¸è§£é¢˜æŠ€å·§ (ç»æ€æŠ€):**
é‡åˆ°è¿™é“é¢˜ï¼Œ**ç»å¯¹ä¸è¦**å»å‚»ç®—çŸ©é˜µä¹˜æ³•ï¼
1. ç›´æ¥çœ‹å›¾ã€‚
2. æ‰¾å‡ºå›¾ä¸­**ç›¸éš”è·ç¦»æœ€è¿œ**çš„ä¸¤ä¸ªç‚¹ï¼ˆæ³¨æ„ï¼Œæ˜¯æŒ‡å®ƒä»¬ä¹‹é—´çš„**==æœ€çŸ­è·¯å¾„==**ï¼Œä¸æ˜¯ç»•è¿œè·¯ï¼‰ã€‚
3. æ•°ä¸€æ•°è¿™ä¸¤ä¸ªç‚¹ä¹‹é—´çš„**==æœ€çŸ­è·¯å¾„==åŒ…å«äº†å‡ æ¡è¾¹ (å¤šå°‘ä¸ª Hop)**ã€‚
4. è¿™ä¸ª**è¾¹æ•°ï¼ˆè·³æ•°ï¼‰**å°±æ˜¯ç­”æ¡ˆçš„æœ€å°å€¼ $n$ï¼
*(è€ƒè¯•æ—¶ç›´æ¥çœ‹å›¾æ•°æœ€è¿œä¸¤ç‚¹çš„æœ€çŸ­è¾¹æ•°å³å¯ç§’æ€ã€‚)*

---

### é¢˜å‹ 2ï¼šDistance Vector ç†è®ºä¸ç®—æ³• (The Protocol Foundation)
**Question:** What algorithm is used for Distance Vector Routing?
**Answer:** A distributed (decentralized) implementation of the **Bellman-Ford** algorithm.
ğŸ“ **å‡ºå¤„ (Source):** *[tutorial08-solution.pdf & retake_2022_en.md]*

**Question:** RIP is a distance vector protocol. What two components does an update contain that a RIP router regularly sends? What essential information is NOT contained?
**Answer:** 
- Contains: Destination and cost to the destination.
- Not contained: Which next hop is required to reach the respective destination (or the complete network topology).
ğŸ“ **å‡ºå¤„ (Source):** *[retake_2019-solution_en.md, Task 2d & 2e]*

ğŸ’¡ **ä¸­æ–‡è§£æ:** 
å¿…é¡»è®°ä½å®ƒå’Œ Link State (å¦‚ OSPF ç”¨çš„ Dijkstra ç®—æ³•) çš„åŒºåˆ«ã€‚Distance Vector (RIP, Bellman-Ford) å°±åƒæ˜¯â€œå£å£ç›¸ä¼ â€å¼çš„å¯»è·¯ï¼Œå®ƒåªå‘Šè¯‰é‚»å±…â€œæˆ‘å» X åœ°ç‚¹è¦ 5 å—é’±â€ï¼Œä½†**ç»ä¸ä¼šå‘Šè¯‰é‚»å±…å…·ä½“çš„è¡Œèµ°è·¯çº¿æˆ–è€…ä¸‹ä¸€è·³æ˜¯è°**ï¼ˆä¸åŒ…å« Next Hopï¼Œæ²¡æœ‰å…¨ç½‘æ‹“æ‰‘ï¼‰ã€‚

---

### é¢˜å‹ 3ï¼šRIP çš„å±€é™æ€§ä¸ Count to Infinity (è·¯ç”±ç¯è·¯é—®é¢˜)
**Question:** To what extent are networks whose routers exclusively use RIP as a routing protocol limited in size?
**Answer:** The hop count of 15 is interpreted as the maximum. A hop count of 16 means unreachable/infinity. So the network diameter is limited.
ğŸ“ **å‡ºå¤„ (Source):** *[retake_2019-solution_en.md, Task 2c]*

**Question (æ‹“å±•):** In case of a route failure, what issue occurs in RIP?
**Answer:** "Count to infinity" problem. (Routers keep incrementing the cost back and forth until it reaches 16).
ğŸ“ **å‡ºå¤„ (Source):** *[retake_2021-solution_en.md, Task 1e]*

ğŸ’¡ **ä¸­æ–‡è§£æ**: è¿™ä¹Ÿæ˜¯å¿…è€ƒæ¦‚å¿µã€‚RIP æœ€å¤§è·³æ•°æ˜¯ 15ï¼Œæ‰€ä»¥ç¨å¾®è¿‡å¤§ä¸€ç‚¹çš„ç½‘å°±è·‘ä¸äº† RIPã€‚åŒæ—¶å› ä¸ºâ€œç›²äººæ‘¸è±¡â€çš„å·¥ä½œåŸç†ï¼Œæ–­ç½‘æ—¶å®¹æ˜“äº§ç”Ÿâ€œä½ ä¾èµ–æˆ‘ï¼Œæˆ‘ä¾èµ–ä½ â€çš„æ­»å¾ªç¯ç´¯åŠ ï¼ˆCount to infinityï¼‰ã€‚

---

### é¢˜å‹ 4ï¼šDistance Vector è¡¨æ ¼æ¨å¯¼ä¸ Count-to-Infinity åº”å¯¹æœºåˆ¶ (Countermeasures)
*(âš ï¸ è¡¥å……è¯´æ˜ï¼šä¹‹å‰çš„å¤§çº²ä¸»è¦ä¾§é‡æœŸä¸­æœŸæœ«çœŸé¢˜ï¼Œè€Œè¿™å¼ è¡¨æ ¼æ¨å¯¼å¤§é¢˜å…¶å®æ˜¯ `[tutorial08-solution.pdf, Problem 3]` çš„æ ¸å¿ƒä½œä¸šé¢˜ã€‚åœ¨æ­¤ä¸ºä½ è¡¥å…¨ï¼)*

**Question 4a & 4c (Tutorial 08 åŸé¢˜é‡ç°):** ç»™å®šä¸€ä¸ªç”± A, B, C, D å››ä¸ªè·¯ç”±å™¨ç»„æˆçš„ç½‘ç»œï¼šçº¿ç¼†æˆæœ¬ä¸º A-B(2), A-C(1), B-C(4), C-D(1)ã€‚å¡«å†™è·¯ç”±å™¨åœ¨äº’ç›¸äº¤æ¢æ›´æ–°æ—¶çš„ Distance Vector è¡¨æ ¼ã€‚ä¹‹åæ–­å¼€ C-D çš„è¿æ¥ï¼Œæ¼”ç¤º Count-to-Infinity æ˜¯å¦‚ä½•å‘ç”Ÿçš„ã€‚

**Step-by-Step æç®€è§£æ³•ä¸è¡¨æ ¼æ¨å¯¼ï¼š**
æˆ‘ä»¬ç”¨ `(Cost, Next Hop)` çš„æ ¼å¼å­˜è¡¨ `[(å»A), (å»B), (å»C), (å»D)]`ã€‚

**é˜¶æ®µä¸€ï¼šåˆå§‹åŒ– (Step 0)**
å¤§å®¶åªè®¤è¯†è‡ªå·±ï¼Œåˆ°è¾¾è‡ªå·±çš„æˆæœ¬ä¸º 0ï¼Œå…¶ä»–å…¨æ˜¯æœªçŸ¥ `(/,/)`ã€‚
- Router A: `[ (0,A), (/,/), (/,/), (/,/) ]`
- Router C: `[ (/,/), (/,/), (0,C), (/,/) ]`

**é˜¶æ®µäºŒï¼šç¬¬ä¸€æ¬¡äº¤æ¢ (Step 1)**
å¤§å®¶æŠŠè‡ªå·±çš„è¡¨å‘ç»™**ç›´æ¥ç›¸è¿çš„é‚»å±…**ã€‚A æ”¶åˆ°äº† B å’Œ C çš„è¡¨ï¼Œå‘ç°èµ° B éœ€è¦ 2ï¼Œèµ° C éœ€è¦ 1ã€‚
- Router A: `[ (0,A), (2,B), (1,C), (/,/) ]` 
- Router C: `[ (1,A), (4,B), (0,C), (1,D) ]` (Cç›´æ¥è¿ç€A,B,D)

**é˜¶æ®µä¸‰ï¼šæ”¶æ•› (Step 2)**
å†æ¬¡äº¤æ¢ï¼æ­¤æ—¶ A ä» C çš„è¡¨é‡Œçœ‹åˆ°äº†â€œC èƒ½åˆ° Dï¼Œæˆæœ¬æ˜¯ 1â€ã€‚é‚£ä¹ˆ A å» D çš„æ€»æˆæœ¬ = Aå»Cçš„æˆæœ¬(1) + Cå»Dçš„æˆæœ¬(1) = 2ã€‚ä¸‹ä¸€è·³å†™ Cã€‚
- Router A: `[ (0,A), (2,B), (1,C), (2,C) ]` 
*(ç½‘å†…æ‰€æœ‰è·¯ç”±å™¨éƒ½åœ¨ 3 æ­¥ä¹‹å†…è·å¾—äº†å…¨å±€æœ€çŸ­è·¯å¾„è®°å½•)*

---
**ğŸ’¥ ç¾éš¾å‘ç”Ÿï¼šC - D é“¾è·¯æ–­å¼€ (Count-to-Infinity è§¦å‘è¿‡ç¨‹)**

1. **Step 4 (æ„ŸçŸ¥æ–­ç½‘)**ï¼šC å’Œ D å‘ç°çº¿æ–­äº†ã€‚C æŠŠå» D çš„æˆæœ¬è®¾ä¸ºæ— ç©·å¤§ã€‚
   - Router C: `[ (1,A), (3,A), (0,C), (æ— ç©·å¤§) ]`
2. **Step 5 (æ¬ºéª—ä¸å¾ªç¯åŠ ä»·)**ï¼šé‡ç‚¹æ¥äº†ï¼C åœ¨ä¸‹ä¸€æ¬¡æ¥å—æ›´æ–°æ—¶ï¼Œæ”¶åˆ°äº† A å‘æ¥çš„è¡¨ã€‚A çš„è¡¨ä¸­å¾—æ„åœ°å†™ç€ï¼šâ€œæˆ‘èƒ½å»Dï¼Œæˆæœ¬åªè¦2ï¼â€ï¼ˆA çš„æ—§è¡¨ï¼š`(2,C)`ï¼‰ã€‚
   - C åƒæŠ“ä½æ•‘å‘½ç¨»è‰ä¸€æ ·ï¼Œè®¤ä¸º A çœŸçš„æœ‰è·¯å» Dã€‚C å†³å®šï¼šæˆ‘è¦å» D å°±å…ˆå» Aã€‚
   - **C çš„æ–°è¡¨ï¼šå» D æˆæœ¬ = Cå»Açš„æˆæœ¬(1) + Aå»Dçš„æˆæœ¬(2) = `3`ã€‚ä¸‹ä¸€è·³å†™å» Aã€‚**
   - Router C å» D æ›´æ–°ä¸ºï¼š`(3,A)`ã€‚
3. **Step 6 (å†æ¬¡æ¬ºéª—)**ï¼šA æ”¶åˆ°äº† C çš„æ–°è¡¨ï¼ˆCè¯´å»Dè¦3ï¼‰ã€‚A æƒ³ï¼šâ€œæˆ‘åŸæ¥å»Dæ˜¯é Cèµ°æ·å¾„(åªéœ€1)ï¼Œç°åœ¨Cæ¶¨ä»·åˆ°3äº†ï¼Œé‚£æˆ‘çš„æ€»æˆæœ¬ä¹Ÿå¾—è·Ÿç€æ¶¨ï¼â€
   - A æ›´æ–°è‡ªå·±å» D çš„æˆæœ¬ = Aå»Cçš„æˆæœ¬(1) + Cå»Dçš„æ–°æˆæœ¬(3) = `4`ã€‚ä¸‹ä¸€è·³è¿˜æ˜¯ Cã€‚
   - Router A å» D æ›´æ–°ä¸ºï¼š`(4,C)`ã€‚
4. **ç»“å±€ (Step 7, 8, 9...)**ï¼š
   - C æ”¶åˆ°äº† A(4)ï¼Œæ¶¨ä»·åˆ° `5`ã€‚A æ”¶åˆ°äº† C(5)ï¼Œæ¶¨ä»·åˆ° `6`ã€‚
   - **ä¸¤ä¸ªè·¯ç”±å™¨äº’ç›¸æ‹¿å¯¹æ–¹ï¼ˆå…¶å®å½’æ ¹ç»“åº•æ˜¯è‡ªå·±æ®‹å­˜çš„åºŸå¼ƒæ•°æ®ï¼‰ä½œä¸ºè·³æ¿ï¼Œç›¸äº’æŠŠå» D çš„ä»·æ ¼+1 å¾€ä¸ŠæŠ¬ã€‚** ç›´åˆ°ä»·æ ¼è¾¾åˆ° **16** ï¼ˆå®šä¹‰ä¸Šçš„æ— ç©·å¤§/ä¸å¯è¾¾ï¼‰ï¼Œå®ƒä»¬æ‰ä¼šåœæ­¢ã€‚è¿™å°±æ˜¯ç»å…¸çš„ **Count-to-Infinity**ã€‚

**Question 4d:** Explain how **Split Horizon**, **Triggered Updates**, and **Path Vector** work as countermeasures for the count-to-infinity problem.
**Answer:**
1. **Split Horizon (æ°´å¹³åˆ†å‰² / â€œä¸èµ°å›å¤´è·¯â€)**:
   - "Do not advertise a route over the interface over which the route was originally learned." 
   - *ï¼ˆç®€å•æ¥è¯´ï¼šå¦‚æœæˆ‘ä»èŠ‚ç‚¹ C é‚£é‡Œå­¦åˆ°äº†å» D çš„è·¯ï¼Œæˆ‘å°±ç»å¯¹ä¸ä¼šå†å‘ C åå‘å¹¿æ’­æˆ‘æ€ä¹ˆå» Dã€‚è¿™å°±é˜²æ­¢äº†ä¸¤ä¸ªèŠ‚ç‚¹äº’ç›¸æ¬ºéª—ã€‚ï¼‰*
2. **Triggered Update (è§¦å‘æ›´æ–° / â€œç«‹åˆ»é€šçŸ¥â€)**:
   - Instead of sending routing updates only at periodic intervals (e.g., 30s), updates are **sent immediately** when topology changes are detected.
   - *ï¼ˆè™½ç„¶ä¸èƒ½æ ¹æœ¬è§£å†³æ­»å¾ªç¯ï¼Œä½†èƒ½æå¤§åŠ é€Ÿâ€œæ•°åˆ° 16â€ çš„è¿‡ç¨‹ï¼Œå‡å°‘é”™è¯¯è·¯ç”±å­˜æ´»çš„æ—¶é—´ã€‚ï¼‰*
3. **Path Vector (è·¯å¾„å‘é‡ / â€œè®°ä¸‹è¶³è¿¹â€)**:
   - Remember where an update came from and include the full path list. If a router discovers itself in this path, it knows a loop is present and discards the update. (Used by **BGP**).
   - *ï¼ˆè¿™å°±æ˜¯ Distance Vector çš„ç©¶æè¿›åŒ–ç‰ˆ BGPï¼ŒæŠŠæ²¿é€”èµ°è¿‡çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½è®°ä¸‹æ¥ï¼Œä¸€çœ‹æ¸…å•ä¸Šæœ‰è‡ªå·±ï¼Œç«‹é©¬ä¸¢å¼ƒæ›´æ–°ï¼Œä»æ ¹æºæ–­ç»ç¯è·¯ã€‚ï¼‰*
ğŸ“ **å‡ºå¤„ (Source):** *[tutorial08-solution.pdf, Task 3d]*
